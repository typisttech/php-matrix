#!/usr/bin/env php
<?php

declare(strict_types=1);

use Composer\Semver\Semver;
use TypistTech\PhpMatrix\Releases\PhpNetReleases;

include $_composer_autoload_path ?? __DIR__.'/../vendor/autoload.php';

$releases = new PhpNetReleases;
$data = $releases->all();
$data = Semver::rsort($data);

$dir = __DIR__.'/../data';
@mkdir($dir, 0755);

$content = json_encode($data, JSON_THROW_ON_ERROR | JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES);
file_put_contents($dir .'/all-versions.json', $content);

echo "Done: '{$dir}/all-versions.json' updated".PHP_EOL;
